---
title: "Mericarp Morphology Preliminary Results"
author: "Daniel Reyes"
date: "3/1/2021"
output:
  html_document:
    df_print: paged
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("00_packages_v1.R", local = knitr::knit_global())
source("01_diagnostic function_v1.R", local = knitr::knit_global())
source("03_data loading_v1.R", local = knitr::knit_global())
source("04_Models per trait_v1.R", local = knitr::knit_global())
```

# Univariate analysis

I ran different models per trait with un-transformed data, log-transformed and sqrt-transformed data. Then I used a custom *diagnostic* function and the package *DHARMa* to compare between models.
Then I selected the model that better fit the assumptions. The model I will show here are the ones selected.
Finally, I used the package *emmeans* to estimate the marginal means per model.

## Model 1: trait ~ mainland/island + year + (1|ID)

This is the first model that looks at the differences between *Tribulus* mericarps, flowers and leaves from mainland and island populations.

### Length -> Sqrt-transformed

```{r Model 1. Length, echo=FALSE}
par(mfrow = c(1,3))
diagnostic(resid(meri_length_m3))

par(mfrow = c(1,2))
plotResiduals(meri_length_m3)
plotQQunif(meri_length_m3)
```

### Model used -> trait ~ finch_beak + year_collected
Finch beak was defined as the islands where there was presence (1) or absence (0) of large ground finches, _G. magnirostris_. Here I am using the raw data. There are some warnings that we may need to check.

```{r ANOVA finch community}
Anova(length_beak_raw)
Anova(width_beak_raw)
Anova(depth_beak_raw)
Anova(spine_beak_raw)
Anova(tip_dist_beak_raw)
Anova(spine_number_beak)
Anova(lower_spines_beak)

```

For finch beaks the traits: **width**, **spine length**, and **spine distance** were not significant.


## General summary plots


```{r Width, echo=FALSE, fig.height=5, fig.width=7, paged.print=FALSE}

library(ggplot2)

ggplot(gal_length) +
 aes(x = finch_beak, y = length) +
 geom_boxplot(fill = "#0c4c8a") +
 theme_minimal()

ggplot(gal_width) +
 aes(x = finch_beak, y = width) +
 geom_boxplot(fill = "#ef562d") +
 theme_minimal()

ggplot(gal_depth) +
 aes(x = finch_beak, y = depth) +
 geom_boxplot(fill = "#440154") +
 theme_minimal()

ggplot(gal_spine_length) +
 aes(x = finch_beak, y = spine_length) +
 geom_boxplot(fill = "#26828e") +
 theme_minimal()

ggplot(gal_tip_distance) +
 aes(x = finch_beak, y = tip_distance) +
 geom_boxplot(fill = "#fdc926") +
 theme_minimal()


```
```{r plot, echo=FALSE, fig.height=5, fig.width=7}

library(ggplot2)

ggplot(tribulus_mericarp) +
 aes(x = mainland_island, y = length) +
 geom_boxplot(fill = "#0c4c8a") +
 theme_minimal()

ggplot(tribulus_mericarp) +
 aes(x = mainland_island, y = width) +
 geom_boxplot(fill = "#440154") +
 theme_minimal()

ggplot(tribulus_mericarp) +
 aes(x = mainland_island, y = depth) +
 geom_boxplot(fill = "#cb181d") +
 theme_minimal()

ggplot(tribulus_mericarp) +
 aes(x = mainland_island, y = spine_length) +
 geom_boxplot(fill = "#006d2c") +
 theme_minimal()

ggplot(tribulus_mericarp) +
 aes(x = mainland_island, y = tip_distance) +
 geom_boxplot(fill = "#fdc926") +
 theme_minimal()

```

